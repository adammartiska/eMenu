{"ast":null,"code":"var _jsxFileName = \"/Users/adammartiska/Projects/eMenu/GUI/eMenu-customer/src/pages/wrapper.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { last } from \"ramda\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useOrderChangedSubscriptionSubscription } from \"../generated/graphql\";\nimport { cacheOrderedDrinksFromWebSocket, cacheOrderedMealsFromWebSocket, updateFinalPriceFromWebSocket, updateOrderStateFromWebSocket } from \"./orderSlice\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Wrapper = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const dispatch = useDispatch();\n  const orderId = useSelector(state => {\n    var _state$order;\n\n    return state === null || state === void 0 ? void 0 : (_state$order = state.order) === null || _state$order === void 0 ? void 0 : _state$order.id;\n  });\n  const token = useSelector(state => {\n    var _state$user;\n\n    return state === null || state === void 0 ? void 0 : (_state$user = state.user) === null || _state$user === void 0 ? void 0 : _state$user.token;\n  });\n  const {\n    data,\n    loading,\n    error\n  } = useOrderChangedSubscriptionSubscription({\n    variables: {\n      orderId,\n      token\n    }\n  });\n  React.useEffect(() => {\n    if (data === null || data === void 0 ? void 0 : data.orderChanged) {\n      var _data$orderChanged, _data$orderChanged2;\n\n      const newSuborder = last(data === null || data === void 0 ? void 0 : data.orderChanged.suborders);\n      console.log(newSuborder);\n      dispatch(updateOrderStateFromWebSocket(data === null || data === void 0 ? void 0 : (_data$orderChanged = data.orderChanged) === null || _data$orderChanged === void 0 ? void 0 : _data$orderChanged.orderState));\n      dispatch(updateFinalPriceFromWebSocket(data === null || data === void 0 ? void 0 : (_data$orderChanged2 = data.orderChanged) === null || _data$orderChanged2 === void 0 ? void 0 : _data$orderChanged2.finalPrice));\n      dispatch(cacheOrderedMealsFromWebSocket(newSuborder === null || newSuborder === void 0 ? void 0 : newSuborder.meals));\n      dispatch(cacheOrderedDrinksFromWebSocket(newSuborder === null || newSuborder === void 0 ? void 0 : newSuborder.drinks));\n    }\n  }, [data, error, dispatch]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 10\n  }, this);\n};\n\n_s(Wrapper, \"OlbXOINr2KN8NJC8dUQtiwH4bDY=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useOrderChangedSubscriptionSubscription];\n});\n\n_c = Wrapper;\n\nvar _c;\n\n$RefreshReg$(_c, \"Wrapper\");","map":{"version":3,"sources":["/Users/adammartiska/Projects/eMenu/GUI/eMenu-customer/src/pages/wrapper.js"],"names":["React","last","useSelector","useDispatch","useOrderChangedSubscriptionSubscription","cacheOrderedDrinksFromWebSocket","cacheOrderedMealsFromWebSocket","updateFinalPriceFromWebSocket","updateOrderStateFromWebSocket","Wrapper","children","dispatch","orderId","state","order","id","token","user","data","loading","error","variables","useEffect","orderChanged","newSuborder","suborders","console","log","orderState","finalPrice","meals","drinks"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,OAArB;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,uCAAT,QAAwD,sBAAxD;AACA,SACEC,+BADF,EAEEC,8BAFF,EAGEC,6BAHF,EAIEC,6BAJF,QAKO,cALP;;AAOA,OAAO,MAAMC,OAAO,GAAG,QAAkB;AAAA;;AAAA,MAAjB;AAAEC,IAAAA;AAAF,GAAiB;AACvC,QAAMC,QAAQ,GAAGR,WAAW,EAA5B;AACA,QAAMS,OAAO,GAAGV,WAAW,CAAEW,KAAD;AAAA;;AAAA,WAAWA,KAAX,aAAWA,KAAX,uCAAWA,KAAK,CAAEC,KAAlB,iDAAW,aAAcC,EAAzB;AAAA,GAAD,CAA3B;AACA,QAAMC,KAAK,GAAGd,WAAW,CAAEW,KAAD;AAAA;;AAAA,WAAWA,KAAX,aAAWA,KAAX,sCAAWA,KAAK,CAAEI,IAAlB,gDAAW,YAAaD,KAAxB;AAAA,GAAD,CAAzB;AAEA,QAAM;AAAEE,IAAAA,IAAF;AAAQC,IAAAA,OAAR;AAAiBC,IAAAA;AAAjB,MAA2BhB,uCAAuC,CAAC;AACvEiB,IAAAA,SAAS,EAAE;AACTT,MAAAA,OADS;AAETI,MAAAA;AAFS;AAD4D,GAAD,CAAxE;AAMAhB,EAAAA,KAAK,CAACsB,SAAN,CAAgB,MAAM;AACpB,QAAIJ,IAAJ,aAAIA,IAAJ,uBAAIA,IAAI,CAAEK,YAAV,EAAwB;AAAA;;AACtB,YAAMC,WAAW,GAAGvB,IAAI,CAACiB,IAAD,aAACA,IAAD,uBAACA,IAAI,CAAEK,YAAN,CAAmBE,SAApB,CAAxB;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYH,WAAZ;AACAb,MAAAA,QAAQ,CAACH,6BAA6B,CAACU,IAAD,aAACA,IAAD,6CAACA,IAAI,CAAEK,YAAP,uDAAC,mBAAoBK,UAArB,CAA9B,CAAR;AACAjB,MAAAA,QAAQ,CAACJ,6BAA6B,CAACW,IAAD,aAACA,IAAD,8CAACA,IAAI,CAAEK,YAAP,wDAAC,oBAAoBM,UAArB,CAA9B,CAAR;AACAlB,MAAAA,QAAQ,CAACL,8BAA8B,CAACkB,WAAD,aAACA,WAAD,uBAACA,WAAW,CAAEM,KAAd,CAA/B,CAAR;AACAnB,MAAAA,QAAQ,CAACN,+BAA+B,CAACmB,WAAD,aAACA,WAAD,uBAACA,WAAW,CAAEO,MAAd,CAAhC,CAAR;AACD;AACF,GATD,EASG,CAACb,IAAD,EAAOE,KAAP,EAAcT,QAAd,CATH;AAWA,sBAAO;AAAA,cAAMD;AAAN;AAAA;AAAA;AAAA;AAAA,UAAP;AACD,CAvBM;;GAAMD,O;UACMN,W,EACDD,W,EACFA,W,EAEmBE,uC;;;KALtBK,O","sourcesContent":["import React from \"react\";\nimport { last } from \"ramda\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useOrderChangedSubscriptionSubscription } from \"../generated/graphql\";\nimport {\n  cacheOrderedDrinksFromWebSocket,\n  cacheOrderedMealsFromWebSocket,\n  updateFinalPriceFromWebSocket,\n  updateOrderStateFromWebSocket,\n} from \"./orderSlice\";\n\nexport const Wrapper = ({ children }) => {\n  const dispatch = useDispatch();\n  const orderId = useSelector((state) => state?.order?.id);\n  const token = useSelector((state) => state?.user?.token);\n\n  const { data, loading, error } = useOrderChangedSubscriptionSubscription({\n    variables: {\n      orderId,\n      token,\n    },\n  });\n  React.useEffect(() => {\n    if (data?.orderChanged) {\n      const newSuborder = last(data?.orderChanged.suborders);\n      console.log(newSuborder);\n      dispatch(updateOrderStateFromWebSocket(data?.orderChanged?.orderState));\n      dispatch(updateFinalPriceFromWebSocket(data?.orderChanged?.finalPrice));\n      dispatch(cacheOrderedMealsFromWebSocket(newSuborder?.meals));\n      dispatch(cacheOrderedDrinksFromWebSocket(newSuborder?.drinks));\n    }\n  }, [data, error, dispatch]);\n\n  return <div>{children}</div>;\n};\n"]},"metadata":{},"sourceType":"module"}